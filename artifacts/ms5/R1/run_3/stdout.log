Final schema:
root
 |-- Date: date (nullable = true)
 |-- symbol: string (nullable = true)
 |-- cluster: integer (nullable = true)
 |-- regime: string (nullable = true)


MS4B Step1 — input summary: rows=33,448, symbols=21, span=2013-05-12 → 2021-07-06
Symbols: AAVE, ADA, ATOM, BNB, BTC, CRO, DOGE, DOT, EOS, ETH, LINK, LTC, MIOTA, SOL, TRX, UNI, WBTC, XEM, XLM, XMR, XRP

Counts by regime:
+--------------------------+-----+
|regime                    |count|
+--------------------------+-----+
|Calm / normal             |15621|
|Choppy high-vol sideways  |7651 |
|Sell-off / drawdown       |4921 |
|Blow-off rally / parabolic|4355 |
|Bull impulse              |900  |
+--------------------------+-----+


Event check — 2020-03-12:
+-------------------+-----+
|regime             |count|
+-------------------+-----+
|Sell-off / drawdown|17   |
+-------------------+-----+


Per-coin distribution (top 3 per coin):
+------+--------------------------+-----+
|symbol|regime                    |count|
+------+--------------------------+-----+
|AAVE  |Choppy high-vol sideways  |121  |
|AAVE  |Sell-off / drawdown       |59   |
|AAVE  |Blow-off rally / parabolic|39   |
|ADA   |Calm / normal             |495  |
|ADA   |Choppy high-vol sideways  |366  |
|ADA   |Sell-off / drawdown       |248  |
|ATOM  |Choppy high-vol sideways  |274  |
|ATOM  |Calm / normal             |255  |
|ATOM  |Sell-off / drawdown       |158  |
|BNB   |Calm / normal             |660  |
|BNB   |Choppy high-vol sideways  |315  |
|BNB   |Blow-off rally / parabolic|201  |
|BTC   |Calm / normal             |2294 |
|BTC   |Blow-off rally / parabolic|345  |
|BTC   |Sell-off / drawdown       |256  |
|CRO   |Calm / normal             |494  |
|CRO   |Choppy high-vol sideways  |151  |
|CRO   |Sell-off / drawdown       |133  |
|DOGE  |Calm / normal             |1433 |
|DOGE  |Choppy high-vol sideways  |590  |
|DOGE  |Sell-off / drawdown       |335  |
|DOT   |Choppy high-vol sideways  |113  |
|DOT   |Calm / normal             |85   |
|DOT   |Sell-off / drawdown       |55   |
|EOS   |Calm / normal             |552  |
|EOS   |Choppy high-vol sideways  |441  |
|EOS   |Sell-off / drawdown       |240  |
|ETH   |Calm / normal             |1026 |
|ETH   |Choppy high-vol sideways  |424  |
|ETH   |Blow-off rally / parabolic|343  |
|LINK  |Choppy high-vol sideways  |522  |
|LINK  |Calm / normal             |332  |
|LINK  |Sell-off / drawdown       |259  |
|LTC   |Calm / normal             |1690 |
|LTC   |Choppy high-vol sideways  |470  |
|LTC   |Sell-off / drawdown       |388  |
|MIOTA |Calm / normal             |537  |
|MIOTA |Choppy high-vol sideways  |451  |
|MIOTA |Sell-off / drawdown       |256  |
|SOL   |Choppy high-vol sideways  |250  |
|SOL   |Sell-off / drawdown       |73   |
|SOL   |Blow-off rally / parabolic|58   |
|TRX   |Calm / normal             |522  |
|TRX   |Choppy high-vol sideways  |395  |
|TRX   |Sell-off / drawdown       |235  |
|UNI   |Choppy high-vol sideways  |159  |
|UNI   |Sell-off / drawdown       |55   |
|UNI   |Blow-off rally / parabolic|39   |
|WBTC  |Calm / normal             |679  |
|WBTC  |Blow-off rally / parabolic|103  |
|WBTC  |Sell-off / drawdown       |72   |
|XEM   |Calm / normal             |768  |
|XEM   |Choppy high-vol sideways  |724  |
|XEM   |Sell-off / drawdown       |377  |
|XLM   |Calm / normal             |1116 |
|XLM   |Choppy high-vol sideways  |613  |
|XLM   |Sell-off / drawdown       |393  |
|XMR   |Calm / normal             |1048 |
|XMR   |Choppy high-vol sideways  |666  |
|XMR   |Sell-off / drawdown       |440  |
|XRP   |Calm / normal             |1576 |
|XRP   |Choppy high-vol sideways  |515  |
|XRP   |Sell-off / drawdown       |385  |
+------+--------------------------+-----+

[TIMING] Step 1 'Step 1: Input & validation' completed in 2.05s → artifacts/ms5/R1/run_3/analysis_out/_timings.jsonl

Top transitions by count:
-------------------------
+--------------------------+--------------------------+-----+
|regime                    |regime_next               |count|
+--------------------------+--------------------------+-----+
|Calm / normal             |Calm / normal             |12109|
|Choppy high-vol sideways  |Choppy high-vol sideways  |4745 |
|Calm / normal             |Blow-off rally / parabolic|1936 |
|Blow-off rally / parabolic|Calm / normal             |1743 |
|Sell-off / drawdown       |Choppy high-vol sideways  |1623 |
|Choppy high-vol sideways  |Sell-off / drawdown       |1550 |
|Calm / normal             |Sell-off / drawdown       |1531 |
|Sell-off / drawdown       |Calm / normal             |1429 |
|Sell-off / drawdown       |Sell-off / drawdown       |1067 |
|Blow-off rally / parabolic|Choppy high-vol sideways  |987  |
|Choppy high-vol sideways  |Blow-off rally / parabolic|826  |
|Blow-off rally / parabolic|Blow-off rally / parabolic|812  |
|Sell-off / drawdown       |Blow-off rally / parabolic|780  |
|Blow-off rally / parabolic|Sell-off / drawdown       |689  |
|Bull impulse              |Bull impulse              |576  |
|Choppy high-vol sideways  |Calm / normal             |330  |
|Bull impulse              |Choppy high-vol sideways  |242  |
|Choppy high-vol sideways  |Bull impulse              |183  |
|Blow-off rally / parabolic|Bull impulse              |116  |
|Bull impulse              |Sell-off / drawdown       |75   |
+--------------------------+--------------------------+-----+
only showing top 20 rows


Transition probability matrix (rows sum ≈ 1.0):
-----------------------------------------------
+--------------------------+---------------------+------------------------+-------------------+--------------------------+---------------------+
|regime                    |Calm / normal        |Choppy high-vol sideways|Sell-off / drawdown|Blow-off rally / parabolic|Bull impulse         |
+--------------------------+---------------------+------------------------+-------------------+--------------------------+---------------------+
|Blow-off rally / parabolic|0.4002296211251435   |0.22663605051664754     |0.1582089552238806 |0.18645235361653273       |0.02663605051664753  |
|Bull impulse              |0.0055617352614015575|0.26918798665183535     |0.08342602892102335|0.0011123470522803114     |0.6407119021134594   |
|Calm / normal             |0.7752737051027595   |0.001856712977783469    |0.09802164030987899|0.12395159741340675       |3.2012292720404634E-4|
|Choppy high-vol sideways  |0.04320502749410841  |0.621235925634983       |0.20293270489656978|0.10814349306101073       |0.023959151610369208 |
|Sell-off / drawdown       |0.29068348250610254  |0.33014646053702196     |0.21704637917005695|0.15866558177379983       |0.0034580960130187145|
+--------------------------+---------------------+------------------------+-------------------+--------------------------+---------------------+


Row-sum check (should be ~1.0):
-------------------------------
+--------------------------+------------------+
|regime                    |row_sum           |
+--------------------------+------------------+
|Calm / normal             |0.9994237787310328|
|Blow-off rally / parabolic|0.998163030998852 |
|Bull impulse              |1.0               |
|Sell-off / drawdown       |1.0               |
|Choppy high-vol sideways  |0.999476302697041 |
+--------------------------+------------------+


Diagonal 'stay' probabilities:
------------------------------
+--------------------------+-------------------+
|regime                    |stay_prob          |
+--------------------------+-------------------+
|Blow-off rally / parabolic|0.18645235361653273|
|Bull impulse              |0.6407119021134594 |
|Calm / normal             |0.7752737051027595 |
|Choppy high-vol sideways  |0.621235925634983  |
|Sell-off / drawdown       |0.21704637917005695|
+--------------------------+-------------------+


Dwell-time stats (overall):
---------------------------
+--------------------------+--------+------------------+-------+-------+-------+-------+
|regime                    |num_runs|mean_len          |p50_len|p90_len|min_len|max_len|
+--------------------------+--------+------------------+-------+-------+-------+-------+
|Blow-off rally / parabolic|3543    |1.2291843070843917|1      |2      |1      |6      |
|Bull impulse              |323     |2.7863777089783284|2      |6      |1      |18     |
|Calm / normal             |3510    |4.450427350427351 |3      |10     |1      |46     |
|Choppy high-vol sideways  |2897    |2.641007939247497 |2      |6      |1      |18     |
|Sell-off / drawdown       |3853    |1.2771866078380483|1      |2      |1      |6      |
+--------------------------+--------+------------------+-------+-------+-------+-------+


Dwell-time per symbol (sample 50 rows):
---------------------------------------
+------+--------------------------+--------+------------------+-------+-------+-------+
|symbol|regime                    |num_runs|mean_len          |p50_len|p90_len|max_len|
+------+--------------------------+--------+------------------+-------+-------+-------+
|AAVE  |Blow-off rally / parabolic|32      |1.21875           |1      |2      |3      |
|AAVE  |Bull impulse              |8       |2.625             |2      |5      |5      |
|AAVE  |Calm / normal             |13      |1.6923076923076923|2      |3      |3      |
|AAVE  |Choppy high-vol sideways  |54      |2.240740740740741 |2      |4      |9      |
|AAVE  |Sell-off / drawdown       |45      |1.3111111111111111|1      |2      |3      |
|ADA   |Blow-off rally / parabolic|166     |1.2650602409638554|1      |2      |5      |
|ADA   |Bull impulse              |11      |3.8181818181818183|1      |9      |9      |
|ADA   |Calm / normal             |154     |3.2142857142857144|2      |7      |26     |
|ADA   |Choppy high-vol sideways  |148     |2.472972972972973 |2      |5      |14     |
|ADA   |Sell-off / drawdown       |191     |1.2984293193717278|1      |2      |6      |
|ATOM  |Blow-off rally / parabolic|109     |1.2201834862385321|1      |2      |4      |
|ATOM  |Bull impulse              |7       |1.7142857142857142|1      |3      |3      |
|ATOM  |Calm / normal             |81      |3.1481481481481484|2      |7      |18     |
|ATOM  |Choppy high-vol sideways  |108     |2.537037037037037 |2      |6      |7      |
|ATOM  |Sell-off / drawdown       |121     |1.3057851239669422|1      |2      |4      |
|BNB   |Blow-off rally / parabolic|162     |1.2407407407407407|1      |2      |4      |
|BNB   |Bull impulse              |13      |4.461538461538462 |3      |7      |18     |
|BNB   |Calm / normal             |155     |4.258064516129032 |2      |12     |24     |
|BNB   |Choppy high-vol sideways  |120     |2.625             |2      |5      |9      |
|BNB   |Sell-off / drawdown       |157     |1.2420382165605095|1      |2      |4      |
|BTC   |Blow-off rally / parabolic|289     |1.193771626297578 |1      |2      |4      |
|BTC   |Bull impulse              |5       |2.6               |1      |6      |6      |
|BTC   |Calm / normal             |401     |5.720698254364089 |3      |13     |46     |
|BTC   |Choppy high-vol sideways  |39      |1.794871794871795 |1      |4      |5      |
|BTC   |Sell-off / drawdown       |214     |1.1962616822429906|1      |2      |4      |
|CRO   |Blow-off rally / parabolic|114     |1.1228070175438596|1      |2      |3      |
|CRO   |Bull impulse              |4       |4.0               |2      |8      |8      |
|CRO   |Calm / normal             |113     |4.371681415929204 |3      |9      |32     |
|CRO   |Choppy high-vol sideways  |65      |2.3230769230769233|2      |5      |9      |
|CRO   |Sell-off / drawdown       |107     |1.2429906542056075|1      |2      |3      |
|DOGE  |Blow-off rally / parabolic|227     |1.2290748898678414|1      |2      |6      |
|DOGE  |Bull impulse              |33      |2.9393939393939394|2      |6      |9      |
|DOGE  |Calm / normal             |250     |5.732             |3      |14     |37     |
|DOGE  |Choppy high-vol sideways  |184     |3.2065217391304346|2      |7      |13     |
|DOGE  |Sell-off / drawdown       |256     |1.30859375        |1      |2      |4      |
|DOT   |Blow-off rally / parabolic|39      |1.1025641025641026|1      |2      |2      |
|DOT   |Bull impulse              |8       |1.375             |1      |3      |3      |
|DOT   |Calm / normal             |37      |2.2972972972972974|2      |4      |9      |
|DOT   |Choppy high-vol sideways  |41      |2.7560975609756095|2      |6      |14     |
|DOT   |Sell-off / drawdown       |41      |1.3414634146341464|1      |2      |3      |
|EOS   |Blow-off rally / parabolic|155     |1.167741935483871 |1      |2      |3      |
|EOS   |Bull impulse              |16      |2.4375            |1      |5      |9      |
|EOS   |Calm / normal             |148     |3.72972972972973  |2      |9      |16     |
|EOS   |Choppy high-vol sideways  |153     |2.8823529411764706|2      |7      |12     |
|EOS   |Sell-off / drawdown       |185     |1.2972972972972974|1      |2      |6      |
|ETH   |Blow-off rally / parabolic|273     |1.2564102564102564|1      |2      |4      |
|ETH   |Bull impulse              |18      |2.5               |2      |5      |5      |
|ETH   |Calm / normal             |275     |3.730909090909091 |2      |9      |27     |
|ETH   |Choppy high-vol sideways  |174     |2.4367816091954024|2      |5      |10     |
|ETH   |Sell-off / drawdown       |236     |1.3093220338983051|1      |2      |6      |
+------+--------------------------+--------+------------------+-------+-------+-------+
only showing top 50 rows


sum equals total rows.
[TIMING] Step 2 'Step 2: Transition stats' completed in 5.80s → artifacts/ms5/R1/run_3/analysis_out/_timings.jsonl

MS4B Step3 — joined rows=33,448 (pred rows=33,448), null ret_1d_w=0

Regime returns — overall (sorted by mean_ret desc):
---------------------------------------------------
+--------------------------+-----+----------------------+----------------------+-------------------+-------------------+--------------------+
|regime                    |n    |mean_ret              |median_ret            |std_ret            |hit_rate           |sharpe_d            |
+--------------------------+-----+----------------------+----------------------+-------------------+-------------------+--------------------+
|Bull impulse              |900  |0.08594528004729445   |0.11211835848958268   |0.08420344454840202|0.83               |1.0206860361619907  |
|Blow-off rally / parabolic|4355 |0.07948469341442341   |0.06907318771053084   |0.03739024925551785|1.0                |2.1258134138459504  |
|Choppy high-vol sideways  |7651 |0.005964359821769656  |0.003927925202722893  |0.04440970775786655|0.5425434583714547 |0.13430306396720557 |
|Calm / normal             |15621|-0.0012750734689526647|-0.0010249972253291162|0.01957918013515314|0.4796107803597721 |-0.06512394595437393|
|Sell-off / drawdown       |4921 |-0.0783669090565946   |-0.07178172428431973  |0.033789075526647  |4.06421459053038E-4|-2.3192972235890945 |
+--------------------------+-----+----------------------+----------------------+-------------------+-------------------+--------------------+


Regime returns — per symbol (top rows by regime):
-------------------------------------------------
+------+--------------------------+----+----------------------+----------------------+--------------------+--------------------+---------------------+
|symbol|regime                    |n   |mean_ret              |median_ret            |std_ret             |hit_rate            |sharpe_d             |
+------+--------------------------+----+----------------------+----------------------+--------------------+--------------------+---------------------+
|UNI   |Blow-off rally / parabolic|39  |0.10191242392013519   |0.10193271863320352   |0.049550961600165665|1.0                 |2.0567193981517904   |
|SOL   |Blow-off rally / parabolic|58  |0.10084316415655416   |0.09016229651889096   |0.04865443268965564 |1.0                 |2.0726408382929167   |
|AAVE  |Blow-off rally / parabolic|39  |0.09742387823926328   |0.0801524818085051    |0.04464964961189123 |1.0                 |2.1819628840562513   |
|DOT   |Blow-off rally / parabolic|43  |0.09109515984704711   |0.08216510453216275   |0.042395766506120744|1.0                 |2.1486852899309077   |
|XEM   |Blow-off rally / parabolic|290 |0.08869701766287039   |0.07697975608006957   |0.04456949161442814 |1.0                 |1.9900836749539492   |
|LINK  |Blow-off rally / parabolic|219 |0.08461950067705895   |0.07824880496729303   |0.03741369848054071 |1.0                 |2.261725093045012    |
|XLM   |Blow-off rally / parabolic|315 |0.08428387923497037   |0.07200661962390864   |0.04147516974180597 |1.0                 |2.032152725586419    |
|DOGE  |Blow-off rally / parabolic|279 |0.0835693952330384    |0.06819617944990597   |0.04583825308381675 |1.0                 |1.8231365641319057   |
|EOS   |Blow-off rally / parabolic|181 |0.08354757873473988   |0.06989823986235866   |0.04040127204349545 |1.0                 |2.067944262863647    |
|TRX   |Blow-off rally / parabolic|181 |0.08349527450715796   |0.07185439662672577   |0.03925928350195938 |1.0                 |2.126765112842439    |
|ATOM  |Blow-off rally / parabolic|133 |0.08130555586712351   |0.06899510807970177   |0.03912472394182799 |1.0                 |2.0781119373011157   |
|ADA   |Blow-off rally / parabolic|210 |0.08077176521782208   |0.07088432928738841   |0.03656538859268272 |1.0                 |2.208967778725746    |
|XRP   |Blow-off rally / parabolic|297 |0.07939486527551007   |0.06817583519489023   |0.03802713782870996 |1.0                 |2.087847516506174    |
|MIOTA |Blow-off rally / parabolic|183 |0.07889685090484247   |0.06742562981134848   |0.03548852045307822 |1.0                 |2.2231654038425566   |
|BNB   |Blow-off rally / parabolic|201 |0.07826556391105194   |0.06694646228293388   |0.03689711064277833 |1.0                 |2.1211840858972635   |
|XMR   |Blow-off rally / parabolic|390 |0.07762964412127257   |0.06785678319340871   |0.03354999964071272 |1.0                 |2.313849327946623    |
|ETH   |Blow-off rally / parabolic|343 |0.07659285138202843   |0.06704246318229856   |0.03270485385509052 |1.0                 |2.3419414048262666   |
|LTC   |Blow-off rally / parabolic|378 |0.07454305900122897   |0.0663906756189494    |0.03158706121943587 |1.0                 |2.359923846139944    |
|CRO   |Blow-off rally / parabolic|128 |0.07446982427394046   |0.06650658505950258   |0.02789798632897141 |1.0                 |2.669361988919081    |
|WBTC  |Blow-off rally / parabolic|103 |0.0667399902825806    |0.06274631249773854   |0.022402597441029404|1.0                 |2.9791184017059176   |
|BTC   |Blow-off rally / parabolic|345 |0.06262566518897997   |0.05880019194966213   |0.020651783690266778|1.0                 |3.032457928488548    |
|SOL   |Bull impulse              |34  |0.11761710236684608   |0.12946634703669346   |0.06784990321188562 |0.9705882352941176  |1.7334896116143976   |
|UNI   |Bull impulse              |13  |0.11336006595431784   |0.13438006316971007   |0.07858164685738629 |0.9230769230769231  |1.442576867344726    |
|ATOM  |Bull impulse              |12  |0.10915217245194764   |0.12869473331273795   |0.06494628717071274 |0.9166666666666666  |1.6806530012260557   |
|DOT   |Bull impulse              |11  |0.10084010725182382   |0.1203584002482807    |0.08250945807864939 |0.8181818181818182  |1.2221642172913239   |
|TRX   |Bull impulse              |46  |0.0990518244518905    |0.1264279345985937    |0.08315908599066581 |0.8913043478260869  |1.1911124716186583   |
|LINK  |Bull impulse              |40  |0.09890754601836903   |0.133015597926609     |0.07934819793634691 |0.9                 |1.2465002179093294   |
|EOS   |Bull impulse              |39  |0.09561970490899104   |0.11353170610515484   |0.0661498399712667  |0.8461538461538461  |1.4455016814934862   |
|DOGE  |Bull impulse              |97  |0.09386942147526305   |0.15557707083411998   |0.10362868731405685 |0.8144329896907216  |0.9058246698694793   |
|MIOTA |Bull impulse              |44  |0.09237324202541995   |0.11282583839730553   |0.06533155640630561 |0.8863636363636364  |1.4139146089056644   |
|XEM   |Bull impulse              |88  |0.09188134092245358   |0.10779830557094461   |0.08389796997252066 |0.8181818181818182  |1.0951557105916594   |
|AAVE  |Bull impulse              |21  |0.09149491019725914   |0.08735141637778465   |0.0791566509093069  |0.9047619047619048  |1.1558714163145773   |
|ETH   |Bull impulse              |45  |0.09147206325227164   |0.11011333250689481   |0.06043075044972439 |0.9111111111111111  |1.5136675048967363   |
|XMR   |Bull impulse              |45  |0.08724012549691396   |0.14106481890125977   |0.0817473650457579  |0.8222222222222222  |1.0671918960088989   |
|XLM   |Bull impulse              |77  |0.07634640839001089   |0.1099242987763851    |0.09309226089298665 |0.7662337662337663  |0.8201155247241679   |
|BNB   |Bull impulse              |58  |0.0758214552657693    |0.11718003820183609   |0.1015135150985928  |0.7241379310344828  |0.746909957675383    |
|XRP   |Bull impulse              |107 |0.07485116879041137   |0.11178676869344661   |0.08532226434359476 |0.794392523364486   |0.8772759298673083   |
|LTC   |Bull impulse              |52  |0.06571415270615401   |0.08887517717328608   |0.07544677827956474 |0.7884615384615384  |0.8710001169652744   |
|ADA   |Bull impulse              |42  |0.0622971544453702    |0.06530458630389502   |0.084788296867366   |0.7857142857142857  |0.7347376553962559   |
|BTC   |Bull impulse              |13  |0.06177205966018938   |0.07657392332204882   |0.03597908813589548 |0.9230769230769231  |1.7168878607170943   |
|CRO   |Bull impulse              |16  |0.05477287139013094   |0.05556209266140266   |0.08451877294141422 |0.8125              |0.6480556861384842   |
|DOT   |Calm / normal             |85  |8.243739247917012E-4  |-0.0013686235231828991|0.02055263162079161 |0.4588235294117647  |0.040110382942773214 |
|BTC   |Calm / normal             |2294|5.85335907306657E-4   |0.001085921638152243  |0.018560555398678753|0.5287707061900611  |0.0315365512902876   |
|WBTC  |Calm / normal             |679 |3.95937774003187E-4   |8.57490883802825E-4   |0.01906691018279876 |0.524300441826215   |0.020765701952085703 |
|BNB   |Calm / normal             |660 |-4.8466884493581565E-4|-0.0011503956025173956|0.020825397368926437|0.47575757575757577 |-0.023272969843014364|
|TRX   |Calm / normal             |522 |-5.233093487309099E-4 |2.7492648143301324E-4 |0.019542404552563574|0.5114942528735632  |-0.02677814530567899 |
|XMR   |Calm / normal             |1048|-5.808864900763592E-4 |-2.2715871312439795E-4|0.021106453488013845|0.49713740458015265 |-0.02752174781074609 |
|CRO   |Calm / normal             |494 |-8.045415112158585E-4 |3.016004325480104E-4  |0.02031081491412447 |0.5080971659919028  |-0.03961148356762226 |
|ETH   |Calm / normal             |1026|-0.001053312253730242 |-0.001354434292327511 |0.01965489726930854 |0.4756335282651072  |-0.05359032099216347 |
|AAVE  |Calm / normal             |22  |-0.0011326530903232072|0.0015998962797070249 |0.02163315928693027 |0.5454545454545454  |-0.05235726669878969 |
|EOS   |Calm / normal             |552 |-0.001226844869659788 |-0.001082558821457802 |0.017647363348456454|0.483695652173913   |-0.06952000961475614 |
|ATOM  |Calm / normal             |255 |-0.0012333697479968253|-0.0013551833292655413|0.022612352056692958|0.47843137254901963 |-0.054544071528010905|
|MIOTA |Calm / normal             |537 |-0.0015740801206936283|-0.0024848634559100358|0.020992437103724587|0.45623836126629425 |-0.07498320051721612 |
|LTC   |Calm / normal             |1690|-0.0016597341039309775|-0.0012804718741898924|0.01880583229588105 |0.4650887573964497  |-0.08825634929726035 |
|XEM   |Calm / normal             |768 |-0.0016922277727388923|-7.645174606603078E-4 |0.020355830378105694|0.48828125          |-0.08313233807248743 |
|LINK  |Calm / normal             |332 |-0.0021488094721155504|-0.003949625759228748 |0.021543087600439985|0.4608433734939759  |-0.0997447307447083  |
|ADA   |Calm / normal             |495 |-0.002192016845434578 |-9.882376808714177E-4 |0.020773706223444474|0.4808080808080808  |-0.1055188141132344  |
|XLM   |Calm / normal             |1116|-0.0022539343971302943|-0.0018899397545180108|0.020679029658165624|0.45878136200716846 |-0.1089961392961334  |
|XRP   |Calm / normal             |1576|-0.0026970869598115423|-0.0032106539207150675|0.01851071533119257 |0.434010152284264   |-0.14570409147109822 |
|DOGE  |Calm / normal             |1433|-0.002953761623167571 |-0.0025615809161223524|0.018361096221072903|0.44033496161898117 |-0.16087065759056146 |
|UNI   |Calm / normal             |13  |-0.0038986563649093552|-0.008752324973141157 |0.01991732243578267 |0.46153846153846156 |-0.1957419918003227  |
|SOL   |Calm / normal             |24  |-0.004385518930408992 |-6.527429925450301E-4 |0.02151129503023551 |0.5                 |-0.20387052124220612 |
|AAVE  |Choppy high-vol sideways  |121 |0.014652772069260907  |0.013673435792806998  |0.05139837199367621 |0.5702479338842975  |0.28508241605519546  |
|MIOTA |Choppy high-vol sideways  |451 |0.010790855509818828  |0.010240669189047757  |0.04848571655056338 |0.5742793791574279  |0.22255741025432868  |
|ATOM  |Choppy high-vol sideways  |274 |0.010435739404540931  |0.007889520103179004  |0.041491479867722315|0.5620437956204379  |0.25151523729234976  |
|XRP   |Choppy high-vol sideways  |515 |0.009221400191740222  |0.0066042177054896345 |0.0412097903976366  |0.5728155339805825  |0.22376721897302038  |
|BTC   |Choppy high-vol sideways  |70  |0.00806656110336959   |0.006617573638271423  |0.030825735561449383|0.5857142857142857  |0.26168268028152486  |
|LINK  |Choppy high-vol sideways  |522 |0.007501178925037615  |0.003480707109032144  |0.048829340411836696|0.5363984674329502  |0.15362032052391308  |
|XMR   |Choppy high-vol sideways  |666 |0.007356750838431302  |0.00459669518188055   |0.041178238104692975|0.545045045045045   |0.17865628004110434  |
|BNB   |Choppy high-vol sideways  |315 |0.006752818001317348  |0.0060441455031257085 |0.043831598522115274|0.6031746031746031  |0.15406278185154956  |
|EOS   |Choppy high-vol sideways  |441 |0.0066961670736372355 |0.003909747630363114  |0.04407321254121899 |0.54421768707483    |0.1519328110555753   |
|UNI   |Choppy high-vol sideways  |159 |0.00652325480959568   |0.006081805374135385  |0.047738626925598375|0.5408805031446541  |0.1366452122672549   |
|ADA   |Choppy high-vol sideways  |366 |0.0063544841417374045 |0.006812275584791916  |0.04119759663529263 |0.5765027322404371  |0.15424404967093946  |
|SOL   |Choppy high-vol sideways  |250 |0.005248655636064738  |9.110135146240816E-4  |0.056470762123288595|0.516               |0.09294465735393692  |
|LTC   |Choppy high-vol sideways  |470 |0.004880509075799588  |0.002047763207195352  |0.03675819913169161 |0.5446808510638298  |0.13277334556881998  |
|TRX   |Choppy high-vol sideways  |395 |0.00437332124492385   |0.0027406911281966373 |0.0479697500411438  |0.5265822784810127  |0.09116831422245975  |
|DOT   |Choppy high-vol sideways  |113 |0.004249226663747172  |0.0042488257414321495 |0.05298864032919262 |0.5221238938053098  |0.08019127566491224  |
|XEM   |Choppy high-vol sideways  |724 |0.004051693413521841  |0.0038440673627366806 |0.043982405941884614|0.5414364640883977  |0.09212077708698964  |
|WBTC  |Choppy high-vol sideways  |21  |0.0037440347245235963 |0.006935111926511084  |0.02510850711292279 |0.6190476190476191  |0.14911419096663953  |
|ETH   |Choppy high-vol sideways  |424 |0.00370101706638797   |0.002094901148745179  |0.03696933337768626 |0.5235849056603774  |0.10011046259821955  |
|CRO   |Choppy high-vol sideways  |151 |0.0028815526116267964 |0.0019825385830802844 |0.030486091955630117|0.5231788079470199  |0.09452023617263401  |
|XLM   |Choppy high-vol sideways  |613 |0.002827980226592221  |1.4704118187514048E-4 |0.043894393497695854|0.5024469820554649  |0.06442691198685022  |
|DOGE  |Choppy high-vol sideways  |590 |0.0016927275441841795 |1.1626499419037373E-4 |0.050143038975098135|0.5033898305084745  |0.033757976755753    |
|WBTC  |Sell-off / drawdown       |72  |-0.06586849323054972  |-0.0670243424631316   |0.01650350603922833 |0.0                 |-3.991181817607866   |
|BTC   |Sell-off / drawdown       |256 |-0.06888797046827108  |-0.06753553477435226  |0.018917700039923067|0.0                 |-3.6414559022974777  |
|CRO   |Sell-off / drawdown       |133 |-0.07392276857780389  |-0.0642135668425654   |0.030945056766873414|0.0                 |-2.388839326898181   |
|ETH   |Sell-off / drawdown       |309 |-0.074053587366097    |-0.06785320134875583  |0.03164071898924735 |0.0                 |-2.340452105126406   |
|LTC   |Sell-off / drawdown       |388 |-0.07481382391632656  |-0.07091435455212647  |0.02960227298742926 |0.0                 |-2.527299979569021   |
|ADA   |Sell-off / drawdown       |248 |-0.07572522755281194  |-0.07253405855641226  |0.033039581962630515|0.0                 |-2.291954772262588   |
|XLM   |Sell-off / drawdown       |393 |-0.07600341486568495  |-0.06827817931511504  |0.03296100215411914 |0.0                 |-2.3058587390731624  |
|DOGE  |Sell-off / drawdown       |335 |-0.07682643856689639  |-0.06988935438147337  |0.034194711157884146|0.005970149253731343|-2.2467345377527135  |
|BNB   |Sell-off / drawdown       |195 |-0.0773511135884932   |-0.07438564922132151  |0.030195386476771394|0.0                 |-2.5616864896893308  |
|XRP   |Sell-off / drawdown       |385 |-0.07756457620538092  |-0.07061120525302544  |0.03082151291968936 |0.0                 |-2.5165726422154706  |
|XMR   |Sell-off / drawdown       |440 |-0.0784317132880968   |-0.0717905196720734   |0.03395450698434591 |0.0                 |-2.3099058196974047  |
|ATOM  |Sell-off / drawdown       |158 |-0.07976990407175603  |-0.07542837503718003  |0.03165434139833406 |0.0                 |-2.520030445996082   |
|DOT   |Sell-off / drawdown       |55  |-0.08048197232018614  |-0.07409793083699712  |0.030232869158056425|0.0                 |-2.6620686213878377  |
|XEM   |Sell-off / drawdown       |377 |-0.0806464257415908   |-0.0735801064994881   |0.035594612439625924|0.0                 |-2.26569191835927    |
|TRX   |Sell-off / drawdown       |235 |-0.08314411057945899  |-0.07425800529710092  |0.03800510088551649 |0.0                 |-2.18770924539618    |
|LINK  |Sell-off / drawdown       |259 |-0.08326592632892207  |-0.07258216312221522  |0.03802004385122402 |0.0                 |-2.190053400641762   |
|MIOTA |Sell-off / drawdown       |256 |-0.08518081460757412  |-0.0765956452428354   |0.03839588580478631 |0.0                 |-2.218488070327466   |
+------+--------------------------+----+----------------------+----------------------+--------------------+--------------------+---------------------+
only showing top 100 rows


MS4B Step3 (FORWARD) — joined rows=33,427 (pred rows=33,448), null ret_fwd1=0

Regime → next-day returns — overall (sorted by mean_ret_fwd1 desc):
-------------------------------------------------------------------
+--------------------------+-----+----------------------+----------------------+-------------------+-------------------+----------------------+
|regime                    |n    |mean_ret_fwd1         |median_ret_fwd1       |std_ret_fwd1       |hit_rate_fwd1      |sharpe_d_fwd1         |
+--------------------------+-----+----------------------+----------------------+-------------------+-------------------+----------------------+
|Bull impulse              |900  |0.011271624276491782  |-0.0012068012433910091|0.10060045729381492|0.49444444444444446|0.1120434695795839    |
|Sell-off / drawdown       |4921 |0.006807391116103117  |0.008640000616753019  |0.06304107205641485|0.5681771997561471 |0.10798342880354649   |
|Blow-off rally / parabolic|4347 |0.003273668975598979  |-0.0040318206423908265|0.05996097652616416|0.463768115942029  |0.05459665878140766   |
|Calm / normal             |15612|4.680578610203948E-4  |-1.332053482743234E-4 |0.03946959877102304|0.4984627209838586 |0.011858693161178616  |
|Choppy high-vol sideways  |7647 |-2.1127517441138702E-4|-0.002131035282372906 |0.06737285279026171|0.48398064600496926|-0.0031359095787305805|
+--------------------------+-----+----------------------+----------------------+-------------------+-------------------+----------------------+


Regime → next-day returns — per symbol (top rows by regime):
------------------------------------------------------------
+------+--------------------------+----+----------------------+----------------------+--------------------+-------------------+---------------------+
|symbol|regime                    |n   |mean_ret_fwd1         |median_ret_fwd1       |std_ret_fwd1        |hit_rate_fwd1      |sharpe_d_fwd1        |
+------+--------------------------+----+----------------------+----------------------+--------------------+-------------------+---------------------+
|AAVE  |Blow-off rally / parabolic|39  |0.03089848802197949   |0.029036865374727938  |0.08125039243883152 |0.6153846153846154 |0.3802872465538069   |
|XRP   |Blow-off rally / parabolic|297 |0.010520631329009359  |-0.0031827162984150448|0.06293761956160711 |0.4713804713804714 |0.1671596638431985   |
|DOT   |Blow-off rally / parabolic|42  |0.009016439346787324  |0.0014036233844019197 |0.061675863645167806|0.5238095238095238 |0.14619072703481706  |
|ETH   |Blow-off rally / parabolic|342 |0.00615754792168842   |-0.0013518261689684508|0.056322713127220696|0.4824561403508772 |0.10932619506059421  |
|LINK  |Blow-off rally / parabolic|218 |0.005659662888978439  |-0.0027200474085221638|0.06506363874106946 |0.48623853211009177|0.08698657189312634  |
|SOL   |Blow-off rally / parabolic|57  |0.0053056361007093105 |0.012038824596517755  |0.0819302816486847  |0.5614035087719298 |0.06475793801685883  |
|BTC   |Blow-off rally / parabolic|345 |0.004728521256290522  |0.002087127436135816  |0.03891934490118097 |0.5478260869565217 |0.12149539691113967  |
|DOGE  |Blow-off rally / parabolic|279 |0.0045366308026828445 |-0.0067985016007892085|0.06517184740365867 |0.41935483870967744|0.06961028394030401  |
|BNB   |Blow-off rally / parabolic|200 |0.003674025777188583  |-0.0016222660046016912|0.05142521248789807 |0.48               |0.07144405631874043  |
|XMR   |Blow-off rally / parabolic|390 |0.0035946382338580885 |-0.0025914372856643553|0.059030588501066905|0.4794871794871795 |0.06089450105673806  |
|ADA   |Blow-off rally / parabolic|210 |0.0035044728339297024 |-0.0036864522193134075|0.060644466191870104|0.47619047619047616|0.05778718247501874  |
|XLM   |Blow-off rally / parabolic|315 |0.0030492108303373363 |-0.009012384867254752 |0.06616162165089906 |0.4380952380952381 |0.04608730490958123  |
|LTC   |Blow-off rally / parabolic|378 |0.0017847910074802768 |-0.004110162754749069 |0.054125886594411816|0.4497354497354497 |0.032974813343095356 |
|TRX   |Blow-off rally / parabolic|181 |0.0012505704878435586 |-0.010462755629787601 |0.06528303919911826 |0.430939226519337  |0.019156131564727293 |
|MIOTA |Blow-off rally / parabolic|182 |1.1187808857093943E-4 |-0.009802944966352145 |0.06374613510906224 |0.41208791208791207|0.001755056810574147 |
|ATOM  |Blow-off rally / parabolic|133 |-0.0010874591928723772|-0.006927790199127815 |0.057963984307386994|0.48120300751879697|-0.018760946230084983|
|WBTC  |Blow-off rally / parabolic|103 |-0.001109708525738098 |-0.002698758983434857 |0.032143361608432536|0.46601941747572817|-0.034523723413140944|
|XEM   |Blow-off rally / parabolic|290 |-0.0012724815513702054|-0.012407214212652118 |0.07255115273842352 |0.4206896551724138 |-0.0175390948777619  |
|EOS   |Blow-off rally / parabolic|181 |-0.0029591092778631822|-0.007502720227809956 |0.06202085117389899 |0.3812154696132597 |-0.047711523170912255|
|CRO   |Blow-off rally / parabolic|127 |-0.0032784379071682545|-0.0011321624660456386|0.051417078248856676|0.47244094488188976|-0.06376165310873444 |
|UNI   |Blow-off rally / parabolic|38  |-0.0050394128342159394|-0.022087219747415787 |0.06553039390415834 |0.3684210526315789 |-0.07690191579782577 |
|BNB   |Bull impulse              |58  |0.025642365345321834  |-0.0012068012433910091|0.11174558584418413 |0.5                |0.2294709464504222   |
|AAVE  |Bull impulse              |21  |0.02476746979750134   |0.020935297742019188  |0.08634032332300881 |0.5714285714285714 |0.28685866399693066  |
|MIOTA |Bull impulse              |44  |0.02441694028849535   |0.041686277077080836  |0.09633721252336595 |0.5454545454545454 |0.2534528418348536   |
|ADA   |Bull impulse              |42  |0.0176641171328299    |0.007576656414284955  |0.09258905241082716 |0.5476190476190477 |0.1907797593008339   |
|XRP   |Bull impulse              |107 |0.017239568345402325  |0.014736489731865365  |0.09945002361420299 |0.5327102803738317 |0.17334906236201486  |
|TRX   |Bull impulse              |46  |0.017027594557701687  |0.01778408068334958   |0.11252542162010103 |0.5217391304347826 |0.1513222017971089   |
|ETH   |Bull impulse              |45  |0.01618429796232714   |0.002155582178774651  |0.08298915764128266 |0.5111111111111111 |0.19501701694916732  |
|BTC   |Bull impulse              |13  |0.01498648626425735   |0.029492065321043093  |0.06992721315249659 |0.6153846153846154 |0.21431550877874922  |
|DOGE  |Bull impulse              |97  |0.014419991533687511  |0.005619990350134607  |0.11827563118540711 |0.5360824742268041 |0.12191853376020415  |
|SOL   |Bull impulse              |34  |0.012329346992485028  |0.0030492216461691646 |0.10144693132387086 |0.5294117647058824 |0.12153494276848455  |
|CRO   |Bull impulse              |16  |0.011746913874099221  |0.012978417150561805  |0.09759134781383096 |0.625              |0.12036839471167148  |
|UNI   |Bull impulse              |13  |0.011431585081720442  |0.019020116670429132  |0.08254822368016017 |0.5384615384615384 |0.13848371984372496  |
|LTC   |Bull impulse              |52  |0.010501216335279985  |-0.002695635936141194 |0.08870989235218311 |0.5                |0.11837706096620637  |
|XLM   |Bull impulse              |77  |0.00826340518542832   |-0.014614495744177836 |0.107939084636489   |0.4675324675324675 |0.07655619105217852  |
|XEM   |Bull impulse              |88  |0.007404243280668053  |-0.012398051365093643 |0.10795062032602859 |0.4659090909090909 |0.06858916843929218  |
|EOS   |Bull impulse              |39  |0.004876470417407228  |-0.011124301507357215 |0.10457522356839953 |0.46153846153846156|0.046631221536119156 |
|ATOM  |Bull impulse              |12  |0.0018109856160416309 |-0.04506000065639615  |0.07229555060043305 |0.3333333333333333 |0.025049752038693    |
|XMR   |Bull impulse              |45  |-0.010074549593759518 |-0.044529246444867776 |0.09612914848443836 |0.37777777777777777|-0.10480223483296965 |
|LINK  |Bull impulse              |40  |-0.013295154923087213 |-0.03020425718575792  |0.0835289660574337  |0.35               |-0.159168196981459   |
|DOT   |Bull impulse              |11  |-0.040485608959889625 |-0.03587292635219219  |0.05985665807047102 |0.18181818181818182|-0.6763760334268031  |
|SOL   |Calm / normal             |24  |0.020015437804123265  |0.00562674889666559   |0.08920507312702308 |0.5833333333333334 |0.2243755551393629   |
|UNI   |Calm / normal             |13  |0.004210204116755067  |0.007755802823308677  |0.0780777975875476  |0.6153846153846154 |0.05392319259561876  |
|DOT   |Calm / normal             |85  |0.003853584352558746  |-0.002867561876043867 |0.0552015201525259  |0.47058823529411764|0.06980938825436339  |
|LINK  |Calm / normal             |332 |0.002979498730818226  |0.0011181959752586401 |0.04687352594468986 |0.5120481927710844 |0.06356463847703701  |
|TRX   |Calm / normal             |521 |0.002437673833242443  |0.0021148861735182933 |0.04225483906690996 |0.5355086372360844 |0.057689814635962046 |
|XMR   |Calm / normal             |1047|0.002213199405967461  |0.0017490688092376416 |0.0424878962068662  |0.5224450811843362 |0.052090115151660524 |
|WBTC  |Calm / normal             |678 |0.0021339695315509524 |0.001875029827626662  |0.033290658799774275|0.5442477876106194 |0.06410115054753503  |
|CRO   |Calm / normal             |494 |0.0020592522093831915 |0.002001480347297857  |0.03870662480699645 |0.5425101214574899 |0.053201544171089014 |
|ETH   |Calm / normal             |1026|0.001246378113496652  |1.622473662532542E-5  |0.041601308712028766|0.5009746588693957 |0.02996006981713701  |
|BTC   |Calm / normal             |2293|0.0010842581209664984 |0.0013837748007414774 |0.03207570672474931 |0.5333624073266463 |0.03380309373292452  |
|EOS   |Calm / normal             |551 |8.696519813084041E-4  |-2.799974072653644E-4 |0.04510549393927413 |0.49909255898366606|0.019280400353873153 |
|BNB   |Calm / normal             |660 |3.3006726322292194E-4 |-0.0010049237726672544|0.04077031359448523 |0.4909090909090909 |0.008095774452604856 |
|DOGE  |Calm / normal             |1432|7.840793571340984E-5  |-0.0014104239827723575|0.035878471380219476|0.4720670391061452 |0.00218537559425226  |
|LTC   |Calm / normal             |1689|5.348022138520929E-5  |-7.248372271675407E-4 |0.03754830234321398 |0.4854943753700414 |0.0014243046435593286|
|ATOM  |Calm / normal             |255 |8.981714478582025E-6  |-0.0010023024605765318|0.04591196583985005 |0.4980392156862745 |1.956290547416769E-4 |
|XLM   |Calm / normal             |1115|-4.209347015074313E-4 |-0.0017392550471022616|0.04124229453215843 |0.4717488789237668 |-0.010206384156904995|
|XEM   |Calm / normal             |768 |-5.531224764965003E-4 |2.8806500669720236E-5 |0.04495484509970668 |0.5013020833333334 |-0.01230395689874392 |
|MIOTA |Calm / normal             |537 |-0.0010294616683829178|-0.0015828565143372053|0.042339021554877586|0.4729981378026071 |-0.024314725059212443|
|XRP   |Calm / normal             |1576|-0.001425136438625566 |-0.002368478034499688 |0.03652045863865515 |0.4536802030456853 |-0.03902296114970275 |
|ADA   |Calm / normal             |494 |-0.0026912670486583467|-0.001315406978491307 |0.04632945253399509 |0.4817813765182186 |-0.05808976582841292 |
|AAVE  |Calm / normal             |22  |-0.010924035868263748 |-0.006915775465497376 |0.056478903206707676|0.45454545454545453|-0.1934179888069491  |
|SOL   |Choppy high-vol sideways  |250 |0.009194061918264829  |9.110135146240816E-4  |0.07777875725437912 |0.516              |0.11820787889674314  |
|BTC   |Choppy high-vol sideways  |70  |0.008244284057987475  |0.01884197551774136   |0.05529644092103419 |0.6142857142857143 |0.1490924898721906   |
|BNB   |Choppy high-vol sideways  |315 |0.006426520803349113  |0.0065284676703525335 |0.06866638927917584 |0.5714285714285714 |0.09359048685698194  |
|ETH   |Choppy high-vol sideways  |424 |0.005377550542274336  |-2.8575238605554887E-5|0.060253862910737636|0.5                |0.0892482287856107   |
|DOT   |Choppy high-vol sideways  |113 |0.005343161802768501  |-0.0024362109168061252|0.07217735973781209 |0.49557522123893805|0.0740282246701432   |
|UNI   |Choppy high-vol sideways  |159 |0.004315770873375823  |0.004647937166191163  |0.07736486626708027 |0.5094339622641509 |0.05578463560548076  |
|AAVE  |Choppy high-vol sideways  |120 |0.003676997497387091  |-5.250528903912866E-4 |0.0824820866417704  |0.49166666666666664|0.04457934622043126  |
|ATOM  |Choppy high-vol sideways  |273 |0.0033488128781729394 |-8.130007920685856E-4 |0.06887451243862239 |0.4908424908424908 |0.04862194677831278  |
|XEM   |Choppy high-vol sideways  |723 |6.301066303406213E-4  |-0.0014288357201968083|0.06451971339412209 |0.49239280774550487|0.009766110188549375 |
|ADA   |Choppy high-vol sideways  |366 |5.678153985990778E-4  |-0.001175519797481872 |0.06426068244282503 |0.4972677595628415 |0.00883612462572714  |
|LINK  |Choppy high-vol sideways  |522 |4.8087117770673015E-4 |-0.004085879407175308 |0.07351641071373384 |0.4827586206896552 |0.006541004559909738 |
|EOS   |Choppy high-vol sideways  |441 |-1.830305433522585E-4 |0.0023917902928474177 |0.06754596659656417 |0.5192743764172335 |-0.002709718323307977|
|DOGE  |Choppy high-vol sideways  |590 |-0.001483912301516373 |-0.0048296627912334245|0.06926929438860666 |0.4661016949152542 |-0.021422367798226705|
|XMR   |Choppy high-vol sideways  |666 |-0.0023239907490814975|-0.005338465018041028 |0.06694621608248166 |0.4624624624624625 |-0.03471429581947103 |
|LTC   |Choppy high-vol sideways  |470 |-0.002497851377550891 |-0.0053289199870034665|0.05935329093102358 |0.46595744680851064|-0.042084463024194   |
|CRO   |Choppy high-vol sideways  |151 |-0.0028479787312770447|-0.006233273905586145 |0.06045681982341711 |0.4503311258278146 |-0.04710765037915408 |
|XRP   |Choppy high-vol sideways  |514 |-0.003003148628791217 |-0.0025742875569078755|0.06143670805224345 |0.47470817120622566|-0.048881991304570764|
|MIOTA |Choppy high-vol sideways  |451 |-0.003426233407757959 |-0.005098634203866359 |0.07058852213145278 |0.4811529933481153 |-0.04853810937389352 |
|XLM   |Choppy high-vol sideways  |613 |-0.004174871837080585 |-0.006686780689380889 |0.06583542481662474 |0.4290375203915171 |-0.06341376012548107 |
|TRX   |Choppy high-vol sideways  |395 |-0.0062138424127115835|-0.0051284063321799245|0.07120164744472302 |0.46582278481012657|-0.08727104829330899 |
|WBTC  |Choppy high-vol sideways  |21  |-0.006903500200008342 |-0.005114284450980833 |0.05636638978152264 |0.47619047619047616|-0.12247547211674298 |
|WBTC  |Sell-off / drawdown       |72  |0.018029598761197783  |0.010105984563862691  |0.0466184878473948  |0.625              |0.3867478246016368   |
|UNI   |Sell-off / drawdown       |55  |0.014985483851741551  |0.01952075756403726   |0.07909523013866057 |0.5818181818181818 |0.18946128389121242  |
|XEM   |Sell-off / drawdown       |377 |0.012512214045171242  |0.010354215202065475  |0.06751995355897573 |0.5941644562334217 |0.185311354431581    |
|SOL   |Sell-off / drawdown       |73  |0.012283892309646749  |0.004284381020953187  |0.08116766143718115 |0.5205479452054794 |0.15133973422597294  |
|BNB   |Sell-off / drawdown       |195 |0.011408236328980388  |0.014237494531175177  |0.062234014145006775|0.6                |0.18331191528797933  |
|ATOM  |Sell-off / drawdown       |158 |0.008540578814632343  |0.009053557544009827  |0.06752317420072212 |0.5759493670886076 |0.12648366898813543  |
|AAVE  |Sell-off / drawdown       |59  |0.007974070539286744  |0.017938964159537996  |0.06917737949043606 |0.576271186440678  |0.11526991334485542  |
|XLM   |Sell-off / drawdown       |393 |0.007925808351802751  |0.009246780818381595  |0.05950272138338435 |0.5852417302798982 |0.13320077078047676  |
|LINK  |Sell-off / drawdown       |259 |0.007885514803416581  |0.007141907177490969  |0.07150058660312775 |0.5598455598455598 |0.11028601551461445  |
|ADA   |Sell-off / drawdown       |248 |0.007099049611880086  |0.010604210357229249  |0.06120906209665015 |0.6008064516129032 |0.11598036906153808  |
|BTC   |Sell-off / drawdown       |256 |0.007006381037167494  |0.008693519314352471  |0.04654247494117615 |0.578125           |0.15053735423444242  |
|MIOTA |Sell-off / drawdown       |256 |0.006822620803356037  |0.014868351442700933  |0.0664610338422639  |0.609375           |0.10265595355541093  |
|TRX   |Sell-off / drawdown       |235 |0.006765161194687112  |0.008006095316526629  |0.0667738595128815  |0.5574468085106383 |0.10131451505183744  |
|DOT   |Sell-off / drawdown       |55  |0.006387035416090736  |0.005455648386461398  |0.07529841529609373 |0.5454545454545454 |0.08482297258149704  |
|ETH   |Sell-off / drawdown       |309 |0.005337292680941007  |0.008797408230194037  |0.0612354719578049  |0.5825242718446602 |0.08716014607707667  |
|XMR   |Sell-off / drawdown       |440 |0.005298816357739953  |0.009223273059782766  |0.06040708618300433 |0.5727272727272728 |0.08771845643550982  |
|LTC   |Sell-off / drawdown       |388 |0.0050064769695765555 |0.007684087645370319  |0.055476705285486434|0.5824742268041238 |0.09024467015142529  |
+------+--------------------------+----+----------------------+----------------------+--------------------+-------------------+---------------------+
only showing top 100 rows

[TIMING] Step 3 'Step 3: Regime returns' completed in 3.50s → artifacts/ms5/R1/run_3/analysis_out/_timings.jsonl

STEP 4 — Transition-conditioned forward returns
-----------------------------------------------
MS4B Step4 — rows_with_prev=33,406, transitions=14,087, stays=19,319
Null ret_fwd1 within transitions: 0

Top transitions by frequency (change points only):
+-----------------------------------------------------+-----+
|transition                                           |count|
+-----------------------------------------------------+-----+
|Calm / normal → Blow-off rally / parabolic           |1935 |
|Blow-off rally / parabolic → Calm / normal           |1743 |
|Sell-off / drawdown → Choppy high-vol sideways       |1624 |
|Choppy high-vol sideways → Sell-off / drawdown       |1553 |
|Calm / normal → Sell-off / drawdown                  |1531 |
|Sell-off / drawdown → Calm / normal                  |1424 |
|Blow-off rally / parabolic → Choppy high-vol sideways|985  |
|Choppy high-vol sideways → Blow-off rally / parabolic|826  |
|Sell-off / drawdown → Blow-off rally / parabolic     |773  |
|Blow-off rally / parabolic → Sell-off / drawdown     |689  |
|Choppy high-vol sideways → Calm / normal             |330  |
|Bull impulse → Choppy high-vol sideways              |242  |
|Choppy high-vol sideways → Bull impulse              |184  |
|Blow-off rally / parabolic → Bull impulse            |116  |
|Bull impulse → Sell-off / drawdown                   |75   |
|Calm / normal → Choppy high-vol sideways             |29   |
|Sell-off / drawdown → Bull impulse                   |17   |
|Bull impulse → Calm / normal                         |5    |
|Calm / normal → Bull impulse                         |5    |
|Bull impulse → Blow-off rally / parabolic            |1    |
+-----------------------------------------------------+-----+


Transition → next-day returns — overall (sorted by mean_ret_fwd1 desc):
+-----------------------------------------------------+----+---------------------+----------------------+--------------------+-------------------+--------------------+
|transition                                           |n   |mean_ret_fwd1        |median_ret_fwd1       |std_ret_fwd1        |hit_rate_fwd1      |sharpe_d_fwd1       |
+-----------------------------------------------------+----+---------------------+----------------------+--------------------+-------------------+--------------------+
|Calm / normal → Bull impulse                         |5   |0.12788102003280125  |0.12194444508392      |0.03182301353442384 |1.0                |4.018507546259526   |
|Bull impulse → Blow-off rally / parabolic            |1   |0.12169844096592675  |0.12169844096592675   |NULL                |1.0                |NULL                |
|Bull impulse → Calm / normal                         |5   |0.04044178004509393  |0.045416120358946266  |0.10373206936794457 |0.6                |0.38986766861503785 |
|Choppy high-vol sideways → Bull impulse              |184 |0.02005478854692664  |-0.005943063985260455 |0.09991873178353611 |0.4782608695652174 |0.20071099971898487 |
|Bull impulse → Sell-off / drawdown                   |75  |0.01729806204818294  |0.012383311979662498  |0.08410357874646618 |0.5866666666666667 |0.20567569544607234 |
|Calm / normal → Choppy high-vol sideways             |29  |0.012821379222115663 |0.007535391057477803  |0.05073191414380599 |0.5517241379310345 |0.25272807932639507 |
|Bull impulse → Choppy high-vol sideways              |242 |0.010761551353815946 |0.005530319499420955  |0.08620875116261104 |0.5289256198347108 |0.1248313101475858  |
|Blow-off rally / parabolic → Bull impulse            |116 |0.010188591837937853 |-0.004373746409938484 |0.0974659618585976  |0.5                |0.10453487190450482 |
|Choppy high-vol sideways → Sell-off / drawdown       |1553|0.008354118743866362 |0.007454062082105306  |0.06776594970270769 |0.557630392788152  |0.12327900340091537 |
|Choppy high-vol sideways → Calm / normal             |330 |0.007965421799363468 |0.0030140360963422097 |0.052360539562472476|0.5333333333333333 |0.1521264269987087  |
|Choppy high-vol sideways → Blow-off rally / parabolic|826 |0.007240716499655666 |-0.003963702556361914 |0.0718850628957237  |0.48426150121065376|0.10072630123672607 |
|Blow-off rally / parabolic → Calm / normal           |1743|0.004938726931616512 |0.0018600081530451007 |0.042197832882382796|0.5272518646012622 |0.11703745415984111 |
|Blow-off rally / parabolic → Choppy high-vol sideways|985 |0.0036316149981628553|9.03826137568009E-4   |0.06455621529757063 |0.5086294416243655 |0.056255079103119596|
|Calm / normal → Blow-off rally / parabolic           |1935|0.003560383447020981 |-0.0020845666614994762|0.050326043796103885|0.47390180878552973|0.07074634082992665 |
|Sell-off / drawdown → Bull impulse                   |17  |0.0010402580728434713|-0.030789467431826867 |0.11781249979627018 |0.4117647058823529 |0.00882977676089006 |
|Calm / normal → Sell-off / drawdown                  |1531|4.582005974933177E-4 |0.006443301029174897  |0.052283238126874486|0.5558458523840627 |0.008763814444342818|
|Blow-off rally / parabolic → Sell-off / drawdown     |689 |4.114977055091372E-4 |0.002553156862969641  |0.05616085525680492 |0.5166908563134979 |0.007327126761647326|
|Sell-off / drawdown → Blow-off rally / parabolic     |773 |2.861665226181814E-4 |-0.006568220246372047 |0.06177852716147527 |0.44372574385511   |0.004632135723634298|
|Sell-off / drawdown → Calm / normal                  |1424|-0.004698006516898746|-0.0018672291845684974|0.04846586224059451 |0.4768258426966292 |-0.09693434305525972|
|Sell-off / drawdown → Choppy high-vol sideways       |1624|-0.008030557297834699|-0.007037870979499594 |0.06960285129968317 |0.458128078817734  |-0.11537684373386084|
+-----------------------------------------------------+----+---------------------+----------------------+--------------------+-------------------+--------------------+


Stay vs Change (is_transition=1 means regime changed today → t+1 return):
+-------------+-----+---------------------+---------------------+-------------------+-------------------+--------------------+
|is_transition|n    |mean_ret_fwd1        |median_ret_fwd1      |std_ret_fwd1       |hit_rate_fwd1      |sharpe_d_fwd1       |
+-------------+-----+---------------------+---------------------+-------------------+-------------------+--------------------+
|true         |14087|0.0022899924252087443|4.0141023243567275E-4|0.06019160049860421|0.504152764960602  |0.03804504957899977 |
|false        |19319|0.0016353420838789946|-1.332053482743234E-4|0.05209105610710016|0.49836948082198873|0.031393913007190744|
+-------------+-----+---------------------+---------------------+-------------------+-------------------+--------------------+

[TIMING] Step 4 'Step 4 — Transition-conditioned returns' completed in 2.69s → artifacts/ms5/R1/run_3/analysis_out/_timings.jsonl

STEP 5 — Breadth series & BTC t+1 correlations
----------------------------------------------

Breadth sample (first 12 rows):
+----------+-------------+------------------------+-------------------+--------------------------+------------+----------+---------+-----------+----------+------------+---------+
|Date      |Calm / normal|Choppy high-vol sideways|Sell-off / drawdown|Blow-off rally / parabolic|Bull impulse|total_syms|frac_calm|frac_choppy|frac_sello|frac_blowoff|frac_bull|
+----------+-------------+------------------------+-------------------+--------------------------+------------+----------+---------+-----------+----------+------------+---------+
|2013-05-12|1            |0                       |1                  |0                         |0           |2         |0.5      |0.0        |0.5       |0.0         |0.0      |
|2013-05-13|2            |0                       |0                  |0                         |0           |2         |1.0      |0.0        |0.0       |0.0         |0.0      |
|2013-05-14|0            |0                       |2                  |0                         |0           |2         |0.0      |0.0        |1.0       |0.0         |0.0      |
|2013-05-15|1            |1                       |0                  |0                         |0           |2         |0.5      |0.5        |0.0       |0.0         |0.0      |
|2013-05-16|0            |1                       |0                  |1                         |0           |2         |0.0      |0.5        |0.0       |0.5         |0.0      |
|2013-05-17|1            |0                       |0                  |1                         |0           |2         |0.5      |0.0        |0.0       |0.5         |0.0      |
|2013-05-18|1            |1                       |0                  |0                         |0           |2         |0.5      |0.5        |0.0       |0.0         |0.0      |
|2013-05-19|1            |1                       |0                  |0                         |0           |2         |0.5      |0.5        |0.0       |0.0         |0.0      |
|2013-05-20|1            |1                       |0                  |0                         |0           |2         |0.5      |0.5        |0.0       |0.0         |0.0      |
|2013-05-21|1            |1                       |0                  |0                         |0           |2         |0.5      |0.5        |0.0       |0.0         |0.0      |
|2013-05-22|2            |0                       |0                  |0                         |0           |2         |1.0      |0.0        |0.0       |0.0         |0.0      |
|2013-05-23|2            |0                       |0                  |0                         |0           |2         |1.0      |0.0        |0.0       |0.0         |0.0      |
+----------+-------------+------------------------+-------------------+--------------------------+------------+----------+---------+-----------+----------+------------+---------+
only showing top 12 rows

VALIDATION OK — per-date regime counts sum to total symbols.

Correlations: frac_{regime} vs BTC t+1 return:
  frac_calm     corr = -0.039755665651040384
  frac_bull     corr = 0.03730056773018991
  frac_sello    corr = 0.03291670807393899
  frac_blowoff  corr = 0.000960696319787264
  frac_choppy   corr = 0.0007825013455020936
[TIMING] Step 5 'Step 5 — Breadth series & BTC correlations' completed in 3.45s → artifacts/ms5/R1/run_3/analysis_out/_timings.jsonl

Step 6 — Cluster characterization
---------------------------------
Numeric features used (6): ['ret_1d_w', 'zscore_7', 'ret_std_7', 'ret_std_30', 'ma_gap_7', 'ma_gap_30']
+-------+----------------------+--------------------+--------------------+--------------------+---------------------+--------------------+-----+
|cluster|avg_ret_1d_w          |avg_zscore_7        |avg_ret_std_7       |avg_ret_std_30      |avg_ma_gap_7         |avg_ma_gap_30       |n    |
+-------+----------------------+--------------------+--------------------+--------------------+---------------------+--------------------+-----+
|0      |0.0794846934144234    |2.1476420276430135  |0.044018592835950235|0.050443684148769076|0.07337236036900327  |0.09687985371236303 |4355 |
|1      |-0.0012750734689526647|-0.05902995025087651|0.032202999081855206|0.03740072880079263 |-0.001085125930937835|-0.00184909739872025|15621|
|2      |-0.07836690905659457  |-1.746533296436608  |0.05336491989700167 |0.0589057284315723  |-0.08203470531185915 |-0.08638440740617807|4921 |
|3      |0.005964359821769656  |0.03712611601991876 |0.07833636390346055 |0.07413685911735984 |0.009702940457837272 |0.07444353501229088 |7651 |
|4      |0.08594528004729443   |0.455230662340629   |0.08897144089093265 |0.07829653568315237 |0.3567776452894824   |1.1963689563048263  |900  |
+-------+----------------------+--------------------+--------------------+--------------------+---------------------+--------------------+-----+

+--------------------------+----------------------+--------------------+--------------------+--------------------+---------------------+--------------------+-----+
|regime                    |avg_ret_1d_w          |avg_zscore_7        |avg_ret_std_7       |avg_ret_std_30      |avg_ma_gap_7         |avg_ma_gap_30       |n    |
+--------------------------+----------------------+--------------------+--------------------+--------------------+---------------------+--------------------+-----+
|Blow-off rally / parabolic|0.0794846934144234    |2.1476420276430135  |0.044018592835950235|0.050443684148769076|0.07337236036900327  |0.09687985371236303 |4355 |
|Bull impulse              |0.08594528004729443   |0.455230662340629   |0.08897144089093265 |0.07829653568315237 |0.3567776452894824   |1.1963689563048263  |900  |
|Calm / normal             |-0.0012750734689526647|-0.05902995025087651|0.032202999081855206|0.03740072880079263 |-0.001085125930937835|-0.00184909739872025|15621|
|Choppy high-vol sideways  |0.005964359821769656  |0.03712611601991876 |0.07833636390346055 |0.07413685911735984 |0.009702940457837272 |0.07444353501229088 |7651 |
|Sell-off / drawdown       |-0.07836690905659457  |-1.746533296436608  |0.05336491989700167 |0.0589057284315723  |-0.08203470531185915 |-0.08638440740617807|4921 |
+--------------------------+----------------------+--------------------+--------------------+--------------------+---------------------+--------------------+-----+

Silhouette (KMeans overall): 0.599

Per-cluster silhouette (approx via centroids)
---------------------------------------------
+-----+-----+------------------+
|kpred|n    |mean_silhouette   |
+-----+-----+------------------+
|0    |9289 |0.5693370200988578|
|1    |15656|0.5902257858229353|
|2    |6593 |0.5530342053919194|
|3    |1245 |0.5488842352144696|
|4    |665  |0.5394155482874555|
+-----+-----+------------------+

[TIMING] Step 6 'Step 6 — Cluster characterization (centroids + silhouette)' completed in 6.90s → artifacts/ms5/R1/run_3/analysis_out/_timings.jsonl
Predictive gauge — train=26,749, test=6,678, test positive-rate=0.508
Baselines — Majority ACC=0.508, Always-Positive F1=0.674, Brier=0.249, proba1 q10/50/90=(0.448, 0.500, 0.544)
+-----+----------+-----+
|label|prediction|count|
+-----+----------+-----+
|0.0  |0.0       |1697 |
|0.0  |1.0       |1588 |
|1.0  |0.0       |1608 |
|1.0  |1.0       |1785 |
+-----+----------+-----+

Predictive gauge metrics — ROC AUC=0.536, PR AUC=0.540, ACC=0.521, P=0.529, R=0.526, F1=0.528
+----------+---------------------+
|feature   |weight               |
+----------+---------------------+
|ret_std_30|-3.694471130535396   |
|ret_1d_w  |-2.576757750838741   |
|ret_std_7 |1.9460009559148297   |
|ma_gap_30 |0.1889408215876527   |
|ma_gap_7  |-0.05995940681397559 |
|zscore_7  |-0.014154951347388249|
+----------+---------------------+

+----+----+----+----+------------------+--------------------+-------------------+---------------------+---------+
|FN  |FP  |TN  |TP  |accuracy          |f1                  |precision          |recall               |threshold|
+----+----+----+----+------------------+--------------------+-------------------+---------------------+---------+
|0   |3285|0   |3393|0.5080862533692723|0.6738159070598749  |0.5080862533692723 |1.0                  |0.1      |
|0   |3285|0   |3393|0.5080862533692723|0.6738159070598749  |0.5080862533692723 |1.0                  |0.2      |
|0   |3285|0   |3393|0.5080862533692723|0.6738159070598749  |0.5080862533692723 |1.0                  |0.3      |
|61  |3221|64  |3332|0.5085354896675651|0.6700180977277298  |0.5084694033267206 |0.9820218096080165   |0.4      |
|1608|1588|1697|1785|0.521413596885295 |0.5276381909547738  |0.5292024903646605 |0.5260831122900088   |0.5      |
|3373|22  |3263|20  |0.4916142557651992|0.011644832605531296|0.47619047619047616|0.0058944886531093425|0.6      |
|3393|0   |3285|0   |0.4919137466307278|0.0                 |0.0                |0.0                  |0.7      |
|3393|0   |3285|0   |0.4919137466307278|0.0                 |0.0                |0.0                  |0.8      |
|3393|0   |3285|0   |0.4919137466307278|0.0                 |0.0                |0.0                  |0.9      |
+----+----+----+----+------------------+--------------------+-------------------+---------------------+---------+

Best F1 @ threshold=0.10 → F1=0.674, P=0.508, R=1.000, ACC=0.508
[TIMING] Step 7 'Step 7 — Predictive gauge' completed in 11.80s → artifacts/ms5/R1/run_3/analysis_out/_timings.jsonl
